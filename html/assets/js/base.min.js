"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}angular.module("bigUtil",[]).run(["$rootScope","$document",function(e,t){FastClick.attach(document.body),viewportUnitsBuggyfill.init();var n=e.$menu={active:!1,open:function(){n.active=!0},close:function(){n.active=!1},toggle:function(e){n.active=!n.active,e&&e.stopPropagation()}};t.on("click",function(){e.$apply(n.close)}),t.on("keyup",function(t){e.$apply(function(){27===t.keyCode&&n.close()})});var i=e.$modal={active:!1,open:function(e){i.active=e},close:function(){i.active=!1},toggle:function(e){i.active=i.active===e?!1:e},isOpen:function(e){return i.active===e}};e.$watch("$modal.active",function(e){angular.element(document.body).css({overflow:e?"hidden":""})}),t.on("keyup",function(t){e.$apply(function(){27===t.keyCode&&i.close()})})}]).filter("length",function(){return function(e){return angular.isArray(e)?e.length:angular.isObject(e)?Object.keys(e).filter(function(e){return"$"!=e[0]}).length:0}}).filter("unique",function(){return function(e,t){if(!e)return e;for(var n={},i=[],a=0;a<e.length;a++)n[angular.isFunction(t)?t(e[a]):e[a][t]]=e[a];for(var r in n)i.push(n[r]);return i}}).directive("bigClickToggle",["$parse",function(e){return{restrict:"A",link:function(t,n,i){var a=t.$eval(i.bigClickToggle);n.on("click",function(n){n.preventDefault(),t.$apply(function(){angular.forEach(a,function(n,i){return e(i).assign(t,n)})})}),angular.forEach(a,function(e,a){t.$watch(a,function(a){void 0!==a&&n[e===a?"addClass":"removeClass"](t.$eval(i.bigClickToggleActive)||"active")})})}}}]),angular.module("XXXXXX",["ui.router","ui.router.title","bigUtil","firebaseHelper","ngHandsontable"]).config(["$locationProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$stateProvider","$firebaseHelperProvider","$provide",function(e,t,n,i,a){e.html5Mode(!0).hashPrefix("!"),t.when("","/"),t.when("/home","/"),n.strictMode(!1);var r=["home","competitions"];i.state("main",{"abstract":!0,templateUrl:"views/main.html"}).state("page",{parent:"main",url:"/{page:|"+r.join("|")+"}",templateUrl:function(e){return"views/page/"+(e.page||"home")+".html"},resolve:{$title:["$stateParams",function(e){switch(e.page){case"":case"home":return"";default:return e.page[0].toUpperCase()+e.page.slice(1)}}]}}).state("competition",{parent:"page",url:"/:competitionId/:section",templateUrl:function(e){var t="";switch(e.section){case"info":t=e.section;break;default:t="table"}return"views/page/competition/"+t+".html"},resolve:{Competition:["$firebaseHelper","$stateParams",function(e,t){return e.object("competitions",t.competitionId)}],CompetitionData:["$firebaseHelper","$stateParams",function(e,t){return e.object("competitionsData",t.competitionId)}],$title:["Competition",function(e){return e.name}]},controller:["$scope","$firebaseHelper","$stateParams","Competition","CompetitionData",function(e,t,n,i,a){var r=n.section;switch(e.competition=i,r){case"info":e.competitionData=a;break;default:e.hot=t.hotTable(a,r),t.load("settings").then(function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=a.settings||{};e.settings=angular.extend(t.all||{},t[r]||{},n.all||{},n[r]||{})})}}]}).state("404",{parent:"main",templateUrl:"views/page/404.html"}),t.otherwise(function(e,t){var n=e.get("$state");return n.go("404",null,{location:!1}),t.path()}),a.namespace("scotdance")}]).controller("AppCtrl",["$rootScope","$scope","$state","$firebaseHelper","$timeout",function(e,t,n,i,a){e.$state=n,i.hotTable=function(){var e={ref:i.ref.apply(this,arguments),parseData:function(t){a(function(){var n=t.exportVal(),i=Object.keys(n||{}).map(function(e){var t=angular.copy(n[e]);return t.$id=e,t});if(e.original=angular.copy(i),e.revisions)console.info(e.revisions+" revision"+(1===e.revisions?" has":"s have")+" been made to this reference since you last saved:",e.ref.path.toString());else{var a;(a=e.data).splice.apply(a,[0,e.data.length].concat(_toConsumableArray(i)))}e.revisions++})},init:function(){e.ref.orderByPriority().on("value",e.parseData)},refresh:function(){e.revisions=0,e.ref.orderByPriority().once("value",e.parseData)},save:function(){var t={};e.data.forEach(function(n){var i=n.$id||e.ref.push().key(),a=angular.copy(n);delete a.$id,angular.forEach(a,function(e,t){(""===e||t.match(/^[^\w\d_]/))&&delete a[t]}),t[i]=a}),console.log("saving",t),e.revisions=0,e.ref.set(t,e.refresh)},dirty:function(){if(e.data&&e.original){var t=e.data.filter(function(e){var t=!1;return angular.forEach(e,function(e){return t=t||e}),t});return!angular.equals(t,e.original)}},revisions:0,data:[]};return e.init(),e}}]).controller("CompetitionsCtrl",["$scope","$firebaseHelper",function(e,t){e.competitions=t.array("competitions")}]);